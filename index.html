<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2025-11-20">
<meta name="keywords" content="dormancy, model calibration, data-scarcity, almond, phenology, flowering">

<title>Supplementary Material to the Manuscript: Combining temperate fruit tree cultivars to fit spring phenology models</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-32162a2fca7cb0439643f2faaab1edf3.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="citation_title" content="Supplementary Material to the Manuscript: Combining temperate fruit tree cultivars to fit spring phenology models">
<meta name="citation_abstract" content="Phenological datasets for temperate fruit trees are often short , fragmented and geographically restricted, which hampers the development of cultivar-specific spring phenology models. To address this, we propose a novel calibration approach (“combined-fitting”), which pools observations from several cultivars of the same species, distinguishing between shared and cultivar-specific parameters. This method requires fewer observations per cultivar and allows jointly analyzing cultivars of the same species. We evaluate combined-fitting using the PhenoFlex framework, comparing it to a baseline model and to models that are fitted only with data for single cultivars (“cultivar-fit”). Our analysis is based on flowering data from nine almond, six apricot and six sweet cherry cultivars across Mediterranean (Spain, Morocco, Tunisia) and German climates. The combined-fit model failed to achieve higher prediction accuracy compared to the cultivar-fit and the baseline approach, as evidenced by similar root mean square errors across the data splits and calibration dataset sizes. When comparing the estimated parameters of the chill and heat accumulation submodels, we observed a large variation among cultivars of the same species in the cultivar-fit models. In contrast and by design, the combined-fit yielded only one parameter set for cultivars of the same species. Our findings demonstrate that integrating data from multiple cultivars can yield spring phenology models with high accuracy. Even though the combined-fit approach did not outperform the cultivar-fit approach, combined-fitting offers a practical solution for spring phenology modeling with limited datasets and facilitates comparison across cultivars of the same species.
">
<meta name="citation_keywords" content="dormancy,model calibration,data-scarcity,almond,phenology,flowering">
<meta name="citation_author" content="Lars Caspersen">
<meta name="citation_author" content="Katja Schiffers">
<meta name="citation_author" content="Katherine Jarvis-Shean">
<meta name="citation_author" content="Eike Luedeling">
<meta name="citation_publication_date" content="2025-11-20">
<meta name="citation_cover_date" content="2025-11-20">
<meta name="citation_year" content="2025">
<meta name="citation_online_date" content="2025-11-20">
<meta name="citation_language" content="en">
<meta name="citation_journal_title" content="International Journal of Biometeorology">
<meta name="citation_reference" content="citation_title=Phenoflex - an Integrated Model to Predict Spring Phenology in Temperate Fruit Trees;,citation_author=Eike Luedeling;,citation_author=Katja Schiffers;,citation_author=Till Fohrmann;,citation_author=Carsten Urbach;,citation_publication_date=2021-09;,citation_cover_date=2021-09;,citation_year=2021;,citation_fulltext_html_url=https://linkinghub.elsevier.com/retrieve/pii/S016819232100174X;,citation_doi=10.1016/j.agrformet.2021.108491;,citation_issn=01681923;,citation_volume=307;,citation_journal_title=Agricultural and Forest Meteorology;">
<meta name="citation_reference" content="citation_title=Reducing the uncertainty on chilling requirements for endodormancy breaking of temperate fruits by data-based parameter estimation of the dynamic model: A test case in apricot;,citation_abstract=The Dynamic model has been described as one of the most accurate models to quantify chill accumulation based on hourly temperatures in nuts and temperate fruits. This model considers that a dynamic process occurs at a biochemical level that determines the endodormancy breaking through the accumulation of the so-called portions. The kinetic parameters present in the model should reflect how the fruit trees integrate chilling exposure and thus they should be characteristic for each species. However, the original parameter values, reported in the late 1980s, are still being used. Even if the use of such parameter values is useful to compare among chilling requirements (CRs) for different species or cultivars, it is not the optimal choice when one intends to explain the CR variations in different years for a given cultivar. In this work we propose a data-based model calibration that makes use of phenological data for different apricot cultivars within different years to obtain model parameters, which minimize the variations among years and that have, at the same time, physical meaning to characterize the incumbent species. Results reveal that the estimation not only reduces the accumulated portion dispersion within the considered time periods but also allows to improve the CR predictions for subsequent years. We propose a set of model parameter values to predict endodormancy breaking dates in the apricot cultivars studied here.;,citation_author=Jose A Egea;,citation_author=José Egea;,citation_author=David Ruiz;,citation_editor=Anil Singh;,citation_publication_date=2021;,citation_cover_date=2021;,citation_year=2021;,citation_fulltext_html_url=https://academic.oup.com/treephys/advance-article/doi/10.1093/treephys/tpaa054/5825604;,citation_issue=4;,citation_doi=10.1093/treephys/tpaa054;,citation_issn=1758-4469;,citation_volume=41;,citation_journal_title=Tree Physiology;">
<meta name="citation_reference" content="citation_title=chillR: Statistical methods for phenology analysis in temperate fruit trees;,citation_author=Eike Luedeling;,citation_author=Lars Caspersen;,citation_author=Eduardo Fernandez;,citation_publication_date=2024;,citation_cover_date=2024;,citation_year=2024;,citation_fulltext_html_url=https://cran.r-project.org/web/packages/chillR/index.html;,citation_publisher=https://cran.r-project.org/web/packages/chillR/;">
<meta name="citation_reference" content="citation_title=Contrasting Responses to Climate Change – Predicting Bloom of Major Temperate Fruit Tree Species in the Mediterranean Region and Central Europe;,citation_author=Lars Caspersen;,citation_author=Katja Schiffers;,citation_author=Antonio Picornell;,citation_author=Jose A. Egea;,citation_author=Alvaro Delgado;,citation_author=Adnane El Yaacoubi;,citation_author=Haïfa Benmoussa;,citation_author=Javier Rodrigo;,citation_author=Erica Fadón;,citation_author=Mehdi Ben Mimoun;,citation_author=Mohamed Ghrab;,citation_author=Ossama Kodad;,citation_author=David Ruiz;,citation_author=Eike Luedeling;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://doi.org/10.1016/j.agrformet.2025.110859;,citation_doi=10.1016/j.agrformet.2025.110859;,citation_volume=375;,citation_journal_title=Agricultural and Forest Meteorology;">
<meta name="citation_reference" content="citation_title=Long-Term Phenology Observations for Temperate Fruit Trees in the Mediterranean Region (and Germany): A Dataset Compiled by the Adamedor Project;,citation_abstract=This dataset contains phenological observations made for temperate fruit and nut tree species in Morocco, Tunisia, Spain, and Germany. Phenology observations include mostly different stages of bloom but in a few cases also fruit ripening. Covered fruit tree species include stone fruit (apricot, sweet cherry, plum, peach), pome fruit (apple, pear), nut (almond, pistachio), and olive. The dataset includes observations made for more than 270 different cultivars. Observations were made in commercially managed orchards. Additionally, the dataset contains daily temperature observations for some of the covered locations.;,citation_author=Eike Luedeling;,citation_author=Lars Caspersen;,citation_author=Alvaro Delgado Delgado;,citation_author=Jose A. Egea;,citation_author=David Ruiz;,citation_author=Mehdi Ben Mimoun;,citation_author=Haïfa Benmoussa;,citation_author=Mohamed Ghrab;,citation_author=Ossama Kodad;,citation_author=Adnane El Yaacoubi;,citation_author=Erica Fadón;,citation_author=Javier Rodrigo;,citation_publication_date=2024-05;,citation_cover_date=2024-05;,citation_year=2024;,citation_fulltext_html_url=https://bonndata.uni-bonn.de/citation?persistentId=doi:10.60507/FK2/MZIELI;,citation_doi=10.60507/FK2/MZIELI;,citation_publisher=bonndata;">
<meta name="citation_reference" content="citation_title=Evalpheno: Wrapper functions to customize calibration of the PhenoFlex phenology model;,citation_abstract=A collection of wrapper functions for the phenology framework PhenoFlex. The functions can be used to customize the function that is used to calculate bloom dates (or any other phenological event). It also contains a set of functions that can be directly supplied to a global optimization algorithm during calibration.;,citation_author=Lars Caspersen;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://zenodo.org/doi/10.5281/zenodo.15174551;,citation_publisher=Zenodo;">
<meta name="citation_reference" content="citation_title=LarsChill: Supplementary functions to the dormancy and phenology R-package chillR;,citation_abstract=Collection of R functions supplementing the chillR package;,citation_author=Lars Caspersen;,citation_publication_date=2025;,citation_cover_date=2025;,citation_year=2025;,citation_fulltext_html_url=https://zenodo.org/doi/10.5281/zenodo.15174333;,citation_publisher=Zenodo;">
<meta name="citation_reference" content="citation_title=Projecting almond bloom dates in California with the PhenoFlex framework;,citation_author=Lars Caspersen;,citation_author=Katherine. Jarvis-Shean;,citation_author=Eike Luedeling;,citation_publication_date=2024-10;,citation_cover_date=2024-10;,citation_year=2024;,citation_fulltext_html_url=https://www.actahort.org/books/1406/1406_64.htm;,citation_issue=1406;,citation_doi=10.17660/ActaHortic.2024.1406.64;,citation_language=en;,citation_journal_title=Acta Horticulturae;">
</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">1</span> Introduction</a></li>
  <li><a href="#supplementary-table" id="toc-supplementary-table" class="nav-link" data-scroll-target="#supplementary-table"><span class="header-section-number">2</span> Supplementary Table</a></li>
  <li><a href="#supplementary-figure" id="toc-supplementary-figure" class="nav-link" data-scroll-target="#supplementary-figure"><span class="header-section-number">3</span> Supplementary Figure</a></li>
  <li><a href="#supplementary-code" id="toc-supplementary-code" class="nav-link" data-scroll-target="#supplementary-code"><span class="header-section-number">4</span> Supplementary Code</a>
  <ul class="collapse">
  <li><a href="#data-splitting" id="toc-data-splitting" class="nav-link" data-scroll-target="#data-splitting"><span class="header-section-number">4.1</span> Data splitting</a></li>
  <li><a href="#model-calibration" id="toc-model-calibration" class="nav-link" data-scroll-target="#model-calibration"><span class="header-section-number">4.2</span> Model Calibration</a></li>
  <li><a href="#model-evaluation" id="toc-model-evaluation" class="nav-link" data-scroll-target="#model-evaluation"><span class="header-section-number">4.3</span> Model Evaluation</a></li>
  </ul></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.docx"><i class="bi bi-file-word"></i>MS Word</a></li><li><a href="index.pdf"><i class="bi bi-file-pdf"></i>PDF (agu)</a></li><li><a href="index-meca.zip" data-meca-link="true"><i class="bi bi-archive"></i>MECA Bundle</a></li></ul></div><div class="quarto-alternate-notebooks"><h2>Notebooks</h2><ul><li><a href="index-preview.html"><i class="bi bi-journal-code"></i>Article Notebook</a></li><li><a href="notebooks\02-calibrate-almond-preview.html"><i class="bi bi-journal-code"></i>Calibrate Almond</a></li><li><a href="notebooks\03-calibrate-apricot-preview.html"><i class="bi bi-journal-code"></i>Calibrate Apricot</a></li><li><a href="notebooks\04-calibrate-cherry-preview.html"><i class="bi bi-journal-code"></i>Calibrate Sweet Cherry</a></li><li><a href="notebooks\05-make-figures-preview.html"><i class="bi bi-journal-code"></i>Evaluate parameters</a></li><li><a href="notebooks\01-prepare-phenology-preview.html"><i class="bi bi-journal-code"></i>Prepare data splits for calibration and validation</a></li></ul></div></nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Supplementary Material to the Manuscript: Combining temperate fruit tree cultivars to fit spring phenology models</h1>
<p class="subtitle lead">Sumbited to International Journal of Biometeorology</p>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Authors</div>
  <div class="quarto-title-meta-heading">Affiliations</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Lars Caspersen <a href="mailto:lcaspers@uni-bonn.de" class="quarto-title-author-email"><i class="bi bi-envelope"></i></a> <a href="https://orcid.org/0009-0000-3057-7327" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Department of Horticultural Sciences, Institue of Crop Science and Resource Conservation (INRES), University of Bonn, Auf dem Hügel 6, 53121 Bonn, Germany
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Katja Schiffers <a href="https://orcid.org/0000-0003-2559-6579" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Department of Horticultural Sciences, Institue of Crop Science and Resource Conservation (INRES), University of Bonn, Auf dem Hügel 6, 53121 Bonn, Germany
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Katherine Jarvis-Shean <a href="https://orcid.org/0000-0001-7097-0625" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            University of California, Division of Agriculture and Natural Resources,70 Cottonwood St, Woodland, CA 95695, USA
          </p>
      </div>
    <div class="quarto-title-meta-contents">
    <p class="author">Eike Luedeling <a href="https://orcid.org/0000-0002-7316-3631" class="quarto-title-author-orcid"> <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg=="></a></p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            Department of Horticultural Sciences, Institue of Crop Science and Resource Conservation (INRES), University of Bonn, Auf dem Hügel 6, 53121 Bonn, Germany
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">November 20, 2025</p>
    </div>
  </div>
  
    
  </div>
  
<div>
  <div class="abstract">
    <div class="block-title">Abstract</div>
    <p>Phenological datasets for temperate fruit trees are often short , fragmented and geographically restricted, which hampers the development of cultivar-specific spring phenology models. To address this, we propose a novel calibration approach (“combined-fitting”), which pools observations from several cultivars of the same species, distinguishing between shared and cultivar-specific parameters. This method requires fewer observations per cultivar and allows jointly analyzing cultivars of the same species. We evaluate combined-fitting using the PhenoFlex framework, comparing it to a baseline model and to models that are fitted only with data for single cultivars (“cultivar-fit”). Our analysis is based on flowering data from nine almond, six apricot and six sweet cherry cultivars across Mediterranean (Spain, Morocco, Tunisia) and German climates. The combined-fit model failed to achieve higher prediction accuracy compared to the cultivar-fit and the baseline approach, as evidenced by similar root mean square errors across the data splits and calibration dataset sizes. When comparing the estimated parameters of the chill and heat accumulation submodels, we observed a large variation among cultivars of the same species in the cultivar-fit models. In contrast and by design, the combined-fit yielded only one parameter set for cultivars of the same species. Our findings demonstrate that integrating data from multiple cultivars can yield spring phenology models with high accuracy. Even though the combined-fit approach did not outperform the cultivar-fit approach, combined-fitting offers a practical solution for spring phenology modeling with limited datasets and facilitates comparison across cultivars of the same species.</p>
  </div>
</div>

<div>
  <div class="keywords">
    <div class="block-title">Keywords</div>
    <p>dormancy, model calibration, data-scarcity, almond, phenology, flowering</p>
  </div>
</div>

</header>


<section id="introduction" class="level2" data-number="1">
<h2 data-number="1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">1</span> Introduction</h2>
<p>This document contains supplementary materials for the journal article: <em>Combining temperate fruit tree cultivar to fit spring phenology models</em>. It includes additional tables and files that were not part of the main article, as well as the code to replicate the analyses.</p>
<p>The phenology analyzed here are part of a long-term phenology dataset <span class="citation" data-cites="luedeling_long-term_2024">(<a href="#ref-luedeling_long-term_2024" role="doc-biblioref">Luedeling, Caspersen, Delgado Delgado, et al., 2024</a>)</span> compiled within the <em>Adapting Mediterranean Orchards (AdaMedOr)</em> project. Of the more than 270 cultivars in the dataset, a subset of 110 cultivars has been analyzed by <span class="citation" data-cites="caspersen_contrasting_2025">Caspersen et al. (<a href="#ref-caspersen_contrasting_2025" role="doc-biblioref">2025</a>)</span> using the PhenoFlex framework <span class="citation" data-cites="luedeling_phenoflex_2021">(<a href="#ref-luedeling_phenoflex_2021" role="doc-biblioref">Luedeling et al., 2021</a>)</span>, available via the R package <em>chillR</em> <span class="citation" data-cites="luedelingChillRStatisticalMethods2024">(<a href="#ref-luedelingChillRStatisticalMethods2024" role="doc-biblioref">Luedeling, Caspersen, &amp; Fernandez, 2024</a>)</span>. In addition to model calibration, the analysis includes climate change impact projections on future bloom dates.</p>
<p>More than 50% of the cultivars in the dataset were not analyzed because the bloom observations were considered too short for calibration with PhenoFlex. We propose an alternative calibration method, <strong>combine- fitting</strong>, which reduces the number parameters estimated per cultivar and may allow the joint analysis of cultivars of the same fruit tree species. We evaluate combined-fit approach for three temperate fruit and nut species (almond, apricot, sweet cherry) and compare the results with those from a baseline model and from a common calibration approach in which each cultivar is calibrated separately. We perform the analysis for the full dataset and for an artificially shortened dataset.</p>
<p>Parts of the function that we present in this document are available via the R packages <em>evalpheno</em> <span class="citation" data-cites="caspersen_evalpheno_2025">(<a href="#ref-caspersen_evalpheno_2025" role="doc-biblioref">Caspersen, 2025a</a>)</span> and <em>LarsChill</em> <span class="citation" data-cites="caspersen_larschill_2025">(<a href="#ref-caspersen_larschill_2025" role="doc-biblioref">Caspersen, 2025b</a>)</span>. Both packages are currently available via GitHub.</p>
</section>
<section id="supplementary-table" class="level2" data-number="2">
<h2 data-number="2" class="anchored" data-anchor-id="supplementary-table"><span class="header-section-number">2</span> Supplementary Table</h2>
<div class="cell" data-tbl_prefix="Table S">
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<caption>Overview on the full bloom dataset for almond, apricot and sweet cherry cultivars</caption>
<colgroup>
<col style="width: 18%">
<col style="width: 22%">
<col style="width: 11%">
<col style="width: 16%">
<col style="width: 15%">
<col style="width: 12%">
<col style="width: 4%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Species</th>
<th style="text-align: left;">Location</th>
<th style="text-align: left;">Country</th>
<th style="text-align: left;">Cultivar</th>
<th style="text-align: right;">Year Start</th>
<th style="text-align: right;">Year End</th>
<th style="text-align: right;">n</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Almond</td>
<td style="text-align: left;">Meknes</td>
<td style="text-align: left;">Morocco</td>
<td style="text-align: left;">Ferragnes</td>
<td style="text-align: right;">1977</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">Almond</td>
<td style="text-align: left;">Meknes</td>
<td style="text-align: left;">Morocco</td>
<td style="text-align: left;">Marcona</td>
<td style="text-align: right;">1977</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Almond</td>
<td style="text-align: left;">Meknes</td>
<td style="text-align: left;">Morocco</td>
<td style="text-align: left;">Tuono</td>
<td style="text-align: right;">1974</td>
<td style="text-align: right;">2014</td>
<td style="text-align: right;">41</td>
</tr>
<tr class="even">
<td style="text-align: left;">Almond</td>
<td style="text-align: left;">Santomera</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Achaak</td>
<td style="text-align: right;">1997</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Almond</td>
<td style="text-align: left;">Santomera</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Desmayo</td>
<td style="text-align: right;">1997</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">Almond</td>
<td style="text-align: left;">Santomera</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Marta</td>
<td style="text-align: right;">2005</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Almond</td>
<td style="text-align: left;">Sfax</td>
<td style="text-align: left;">Tunisia</td>
<td style="text-align: left;">Fasciuneddu</td>
<td style="text-align: right;">1981</td>
<td style="text-align: right;">2015</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">Almond</td>
<td style="text-align: left;">Sfax</td>
<td style="text-align: left;">Tunisia</td>
<td style="text-align: left;">Mazzetto</td>
<td style="text-align: right;">1981</td>
<td style="text-align: right;">2015</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Almond</td>
<td style="text-align: left;">Sfax</td>
<td style="text-align: left;">Tunisia</td>
<td style="text-align: left;">Nonpareil</td>
<td style="text-align: right;">1981</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Apricot</td>
<td style="text-align: left;">Cieza</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Bulida</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Apricot</td>
<td style="text-align: left;">Cieza</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Dorada</td>
<td style="text-align: right;">2003</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Apricot</td>
<td style="text-align: left;">Zaragoza</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Goldrich</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Apricot</td>
<td style="text-align: left;">Zaragoza</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Harcot</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">Apricot</td>
<td style="text-align: left;">Zaragoza</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Henderson</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Apricot</td>
<td style="text-align: left;">Zaragoza</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Sunglo</td>
<td style="text-align: right;">1999</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sweet Cherry</td>
<td style="text-align: left;">Klein-Altendorf</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">Burlat</td>
<td style="text-align: right;">1978</td>
<td style="text-align: right;">2015</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sweet Cherry</td>
<td style="text-align: left;">Klein-Altendorf</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">Regina</td>
<td style="text-align: right;">1988</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sweet Cherry</td>
<td style="text-align: left;">Klein-Altendorf</td>
<td style="text-align: left;">Germany</td>
<td style="text-align: left;">Schneiders</td>
<td style="text-align: right;">1984</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sweet Cherry</td>
<td style="text-align: left;">Zaragoza</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Rainier</td>
<td style="text-align: right;">1991</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sweet Cherry</td>
<td style="text-align: left;">Zaragoza</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Sam</td>
<td style="text-align: right;">1991</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sweet Cherry</td>
<td style="text-align: left;">Zaragoza</td>
<td style="text-align: left;">Spain</td>
<td style="text-align: left;">Van</td>
<td style="text-align: right;">1991</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">24</td>
</tr>
</tbody>
</table>
</div>
<a class="quarto-notebook-link" id="nblink-1" href="index-preview.html">Source: Article Notebook</a></div>
</section>
<section id="supplementary-figure" class="level2" data-number="3">
<h2 data-number="3" class="anchored" data-anchor-id="supplementary-figure"><span class="header-section-number">3</span> Supplementary Figure</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="images/rmse_slim_bycultivar.jpeg" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="Root Mean Square Error (RMSE, days) of predicted bloom dates for each species (almond, apricot, sweet cherry) and cultivar (indicated at the x-axis). Boxplot summarizes RMSE for calibration and validation split and for ‘scarce’ and ‘full’ calibration sets. Calibration methods are indicated by color, green for ‘Baseline Model’, yellow for ‘Cultivar-Fit’ and blue for ‘Combined-Fit’."><img src="images/rmse_slim_bycultivar.jpeg" class="img-fluid figure-img" alt="Root Mean Square Error (RMSE, days) of predicted bloom dates for each species (almond, apricot, sweet cherry) and cultivar (indicated at the x-axis). Boxplot summarizes RMSE for calibration and validation split and for ‘scarce’ and ‘full’ calibration sets. Calibration methods are indicated by color, green for ‘Baseline Model’, yellow for ‘Cultivar-Fit’ and blue for ‘Combined-Fit’."></a></p>
<figcaption>Root Mean Square Error (RMSE, days) of predicted bloom dates for each species (almond, apricot, sweet cherry) and cultivar (indicated at the x-axis). Boxplot summarizes RMSE for calibration and validation split and for ‘scarce’ and ‘full’ calibration sets. Calibration methods are indicated by color, green for ‘Baseline Model’, yellow for ‘Cultivar-Fit’ and blue for ‘Combined-Fit’.</figcaption>
</figure>
</div>
</section>
<section id="supplementary-code" class="level2" data-number="4">
<h2 data-number="4" class="anchored" data-anchor-id="supplementary-code"><span class="header-section-number">4</span> Supplementary Code</h2>
<section id="data-splitting" class="level3" data-number="4.1">
<h3 data-number="4.1" class="anchored" data-anchor-id="data-splitting"><span class="header-section-number">4.1</span> Data splitting</h3>
<p>This notebook shows the preparation of the phenology data. Performs calibration and validation data splits. Check out the notebook for more details:</p>
<p><a href="https://larscaspersen.github.io/combined-fitting-bloom/notebooks/01-prepare-phenology-preview.html">Split data in calibration and validation</a></p>
</section>
<section id="model-calibration" class="level3" data-number="4.2">
<h3 data-number="4.2" class="anchored" data-anchor-id="model-calibration"><span class="header-section-number">4.2</span> Model Calibration</h3>
<p>When calibrating the model, we specified the search space for each model parameter. We substituted the model parameters E<sub>0</sub>, E<sub>1</sub>, A<sub>0</sub> and A<sub>1</sub> of the chill submodel with intermediate parameters <span class="math inline">\(\theta^*\)</span> , <span class="math inline">\(\theta_c\)</span> , <span class="math inline">\(\pi_c\)</span> and <span class="math inline">\(\tau\)</span> , following <span class="citation" data-cites="egea_reducing_2021">Egea et al. (<a href="#ref-egea_reducing_2021" role="doc-biblioref">2021</a>)</span> and implemented for PhenoFlex by <span class="citation" data-cites="caspersen2024">Caspersen et al. (<a href="#ref-caspersen2024" role="doc-biblioref">2024</a>)</span>. Additionally, we restricted parameters, so that the <code>E10</code> quotient of the process modeling chill formation and degradation ranges between 1.5 and 3.5, a range said to be realistic in biological systems <span class="citation" data-cites="egea_reducing_2021 luedeling_phenoflex_2021">(<a href="#ref-egea_reducing_2021" role="doc-biblioref">Egea et al., 2021</a>; <a href="#ref-luedeling_phenoflex_2021" role="doc-biblioref">Luedeling et al., 2021</a>)</span>. During model calibration, the optimization algorithm ran for 5,000 iterations for baseline model; 30,000 evaluations for single-fit; 50,000 evaluations for combined fit. We chose different total number of evaluations for the calibration methods, to account for varying number of model parameters estimated during each individual calibration step. The optimization algorithm estimates model parameters by minimizing the residual sum of squares (RSS) of predicted and observed bloom dates. In a pre-trial we confirmed that by the end of the total number of model evaluations the RSS converged, indicating that the algorithm fails to find parameters providing better model performance.</p>
<p>These three notebooks perform the model calibration. The notebook for almond calibration has also some more comments on the different procedures. The notebooks for apricot and sweet cherry only contain the uncommented code.</p>
<ul>
<li><p><a href="https://larscaspersen.github.io/combined-fitting-bloom/notebooks/02-calibrate-almond-preview.html">Almond calibration</a></p></li>
<li><p><a href="https://larscaspersen.github.io/combined-fitting-bloom/notebooks/03-calibrate-apricot-preview.html">Apricot calibration</a></p></li>
<li><p><a href="https://larscaspersen.github.io/combined-fitting-bloom/notebooks/04-calibrate-cherry-preview.html">Sweet Cherry calibration</a></p></li>
</ul>
</section>
<section id="model-evaluation" class="level3" data-number="4.3">
<h3 data-number="4.3" class="anchored" data-anchor-id="model-evaluation"><span class="header-section-number">4.3</span> Model Evaluation</h3>
<p>This code shows how the calibrated models are evaluated. This script generates figures and tables for the manuscript.</p>
<p><a href="https://larscaspersen.github.io/combined-fitting-bloom/notebooks/05-make-figures-preview.html">Generate figures for the manuscript</a></p>
</section>
</section>
<section id="references" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="references">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-caspersen_evalpheno_2025" class="csl-entry" role="listitem">
Caspersen, L. (2025a). <em>Evalpheno: <span>Wrapper</span> functions to customize calibration of the <span>PhenoFlex</span> phenology model</em>. Zenodo. <a href="https://zenodo.org/doi/10.5281/zenodo.15174551">https://zenodo.org/doi/10.5281/zenodo.15174551</a>
</div>
<div id="ref-caspersen_larschill_2025" class="csl-entry" role="listitem">
Caspersen, L. (2025b). <em><span>LarsChill</span>: <span>Supplementary</span> functions to the dormancy and phenology <span>R</span>-package <span class="nocase">chillR</span></em>. Zenodo. <a href="https://zenodo.org/doi/10.5281/zenodo.15174333">https://zenodo.org/doi/10.5281/zenodo.15174333</a>
</div>
<div id="ref-caspersen2024" class="csl-entry" role="listitem">
Caspersen, L., Jarvis-Shean, Katherine., &amp; Luedeling, E. (2024). Projecting almond bloom dates in California with the PhenoFlex framework. <em>Acta Horticulturae</em>, <em>1406</em>, 455–464. <a href="https://doi.org/10.17660/ActaHortic.2024.1406.64">https://doi.org/10.17660/ActaHortic.2024.1406.64</a>
</div>
<div id="ref-caspersen_contrasting_2025" class="csl-entry" role="listitem">
Caspersen, L., Schiffers, K., Picornell, A., Egea, J. A., Delgado, A., El Yaacoubi, A., Benmoussa, H., Rodrigo, J., Fadón, E., Ben Mimoun, M., Ghrab, M., Kodad, O., Ruiz, D., &amp; Luedeling, E. (2025). Contrasting <span>Responses</span> to <span>Climate</span> <span>Change</span> – <span>Predicting</span> <span>Bloom</span> of <span>Major</span> <span>Temperate</span> <span>Fruit</span> <span>Tree</span> <span>Species</span> in the <span>Mediterranean</span> <span>Region</span> and <span>Central</span> <span>Europe</span>. <em>Agricultural and Forest Meteorology</em>, <em>375</em>, 110859. <a href="https://doi.org/10.1016/j.agrformet.2025.110859">https://doi.org/10.1016/j.agrformet.2025.110859</a>
</div>
<div id="ref-egea_reducing_2021" class="csl-entry" role="listitem">
Egea, J. A., Egea, J., &amp; Ruiz, D. (2021). Reducing the uncertainty on chilling requirements for endodormancy breaking of temperate fruits by data-based parameter estimation of the dynamic model: A test case in apricot. <em>Tree Physiology</em>, <em>41</em>(4), 644–656. <a href="https://doi.org/10.1093/treephys/tpaa054">https://doi.org/10.1093/treephys/tpaa054</a>
</div>
<div id="ref-luedeling_long-term_2024" class="csl-entry" role="listitem">
Luedeling, E., Caspersen, L., Delgado Delgado, A., Egea, J. A., Ruiz, D., Ben Mimoun, M., Benmoussa, H., Ghrab, M., Kodad, O., El Yaacoubi, A., Fadón, E., &amp; Rodrigo, J. (2024). <em>Long-<span>Term</span> <span>Phenology</span> <span>Observations</span> for <span>Temperate</span> <span>Fruit</span> <span>Trees</span> in the <span>Mediterranean</span> <span>Region</span> (and <span>Germany</span>): <span>A</span> <span>Dataset</span> <span>Compiled</span> by the <span>Adamedor</span> <span>Project</span></em>. bonndata. <a href="https://doi.org/10.60507/FK2/MZIELI">https://doi.org/10.60507/FK2/MZIELI</a>
</div>
<div id="ref-luedelingChillRStatisticalMethods2024" class="csl-entry" role="listitem">
Luedeling, E., Caspersen, L., &amp; Fernandez, E. (2024). <em><span class="nocase">chillR</span>: <span>Statistical</span> methods for phenology analysis in temperate fruit trees</em>. https://cran.r-project.org/web/packages/chillR/. <a href="https://cran.r-project.org/web/packages/chillR/index.html">https://cran.r-project.org/web/packages/chillR/index.html</a>
</div>
<div id="ref-luedeling_phenoflex_2021" class="csl-entry" role="listitem">
Luedeling, E., Schiffers, K., Fohrmann, T., &amp; Urbach, C. (2021). Phenoflex - an <span>Integrated</span> <span>Model</span> to <span>Predict</span> <span>Spring</span> <span>Phenology</span> in <span>Temperate</span> <span>Fruit</span> <span>Trees</span>. <em>Agricultural and Forest Meteorology</em>, <em>307</em>, 108491. <a href="https://doi.org/10.1016/j.agrformet.2021.108491">https://doi.org/10.1016/j.agrformet.2021.108491</a>
</div>
</div>
</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@online{caspersen2025,
  author = {Caspersen, Lars and Schiffers, Katja and Jarvis-Shean,
    Katherine and Luedeling, Eike},
  title = {Supplementary {Material} to the {Manuscript:} {Combining}
    Temperate Fruit Tree Cultivars to Fit Spring Phenology Models},
  date = {2025-11-20},
  langid = {en},
  abstract = {Phenological datasets for temperate fruit trees are often
    short , fragmented and geographically restricted, which hampers the
    development of cultivar-specific spring phenology models. To address
    this, we propose a novel calibration approach (“combined-fitting”),
    which pools observations from several cultivars of the same species,
    distinguishing between shared and cultivar-specific parameters. This
    method requires fewer observations per cultivar and allows jointly
    analyzing cultivars of the same species. We evaluate
    combined-fitting using the PhenoFlex framework, comparing it to a
    baseline model and to models that are fitted only with data for
    single cultivars (“cultivar-fit”). Our analysis is based on
    flowering data from nine almond, six apricot and six sweet cherry
    cultivars across Mediterranean (Spain, Morocco, Tunisia) and German
    climates. The combined-fit model failed to achieve higher prediction
    accuracy compared to the cultivar-fit and the baseline approach, as
    evidenced by similar root mean square errors across the data splits
    and calibration dataset sizes. When comparing the estimated
    parameters of the chill and heat accumulation submodels, we observed
    a large variation among cultivars of the same species in the
    cultivar-fit models. In contrast and by design, the combined-fit
    yielded only one parameter set for cultivars of the same species.
    Our findings demonstrate that integrating data from multiple
    cultivars can yield spring phenology models with high accuracy. Even
    though the combined-fit approach did not outperform the cultivar-fit
    approach, combined-fitting offers a practical solution for spring
    phenology modeling with limited datasets and facilitates comparison
    across cultivars of the same species.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-caspersen2025" class="csl-entry quarto-appendix-citeas" role="listitem">
Caspersen, L., Schiffers, K., Jarvis-Shean, K., &amp; Luedeling, E.
(2025, November 20). <em>Supplementary Material to the Manuscript:
Combining temperate fruit tree cultivars to fit spring phenology
models</em>. International Journal of Biometeorology.
</div></div></section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","loop":false,"openEffect":"zoom","selector":".lightbox"});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>