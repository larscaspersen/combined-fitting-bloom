% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
]{agujournal2019}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother


\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother
% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\usepackage{url} %this package should fix any errors with URLs in refs.
\usepackage{lineno}
\usepackage[inline]{trackchanges} %for better track changes. finalnew option will compile document with changes incorporated.
\usepackage{soul}
\linenumbers
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother

\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Supplementary Materials to the Manuscript: Combining temperate fruit tree cultivars to fit spring phenology models},
  pdfkeywords={dormancy, model
calibration, data-scarcity, almond, phenology, flowering},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\journalname{International Journal of Biometeorology}

\draftfalse

\begin{document}
\title{Supplementary Materials to the Manuscript: Combining temperate
fruit tree cultivars to fit spring phenology models}

\authors{Lars Caspersen\affil{1}, Katja Schiffers\affil{1}, Katherine
Jarvis-Shean\affil{2}, Eike Luedeling\affil{1}}
\affiliation{1}{Department of Horticultural Sciences, Institue of Crop
Science and Resource Conservation (INRES), University of Bonn, Auf dem
HÃ¼gel 6, 53121 Bonn, Germany, }\affiliation{2}{University of California,
Division of Agriculture and Natural Resources,70 Cottonwood St,
Woodland, CA 95695, USA, }
\correspondingauthor{Lars Caspersen}{lcaspers@uni-bonn.de}


\begin{abstract}
Phenological datasets for temperate fruit trees are often short ,
fragmented and geographically restricted, which hampers the development
of cultivar-specific spring phenology models. To address this, we
propose a novel calibration approach (``combined-fitting''), which pools
observations from several cultivars of the same species, distinguishing
between shared and cultivar-specific parameters. This method requires
fewer observations per cultivar and allows jointly analyzing cultivars
of the same species. We evaluate combined-fitting using the PhenoFlex
framework, comparing it to a baseline model and to models that are
fitted only with data for single cultivars (``cultivar-fit''). Our
analysis is based on flowering data from nine almond, six apricot and
six sweet cherry cultivars across Mediterranean (Spain, Morocco,
Tunisia) and German climates. The combined-fit model failed to achieve
higher prediction accuracy compared to the cultivar-fit and the baseline
approach, as evidenced by similar root mean square errors across the
data splits and calibration dataset sizes. When comparing the estimated
parameters of the chill and heat accumulation submodels, we observed a
large variation among cultivars of the same species in the cultivar-fit
models. In contrast and by design, the combined-fit yielded only one
parameter set for cultivars of the same species. Our findings
demonstrate that integrating data from multiple cultivars can yield
spring phenology models with high accuracy. Even though the combined-fit
approach did not outperform the cultivar-fit approach, combined-fitting
offers a practical solution for spring phenology modeling with limited
datasets and facilitates comparison across cultivars of the same
species.
\end{abstract}





\section{Introduction}\label{introduction}

This document contains supplementary materials for the journal article:
\emph{Combining temperate fruit tree cultivar to fit spring phenology
models}. It contains some extra tables and files that were not included
in the main article. Also, it contains code snippets that help the
reader to replicate parts of the analyses.

The phenology data that we analyse is part of a long-term phenology
dataset (Luedeling, Caspersen, Delgado Delgado, et al., 2024) compiled
by the \emph{Adapting Mediterranean Orchards (AdaMedOr)} project. Of the
more than 270 cultivars comprised by the dataset, a subset of 110
cultivars has been analyzed with the PhenoFlex framework (Luedeling et
al., 2021), available via the R package \emph{chillR} (Luedeling,
Caspersen, \& Fernandez, 2024). The analysis contains next to model
calibration also climate change impact projections on future bloom dates
(Caspersen et al., 2025).

More than 50\% of the cultivars in the dataset were not analysed,
because the bloom observations were deemed too short to be analysed with
PhenoFlex. We propose an alternative calibration method called
combine-fitting, that reduces the number of model parameters estimated
per cultivar and may allow the joined analysis too short for
conventional model calibration. We evaluate the method for three
temperate fruit and nut trees (almond, apricot, sweet cherry) and
compared the results with a baseline model and a common calibration
approach where each cultivar is calibrated separately. We perform the
analysis for the full dataset and an artificially shortened dataset.

Parts of the function that we present in this document are available via
the R packages \emph{evalpheno} (Caspersen, 2025a) and \emph{LarsChill}
(Caspersen, 2025b). Both packages are currently available via GitHub.

\section{Preparing Bloom Data}\label{preparing-bloom-data}

This notebook shows the preparation of the phenology data. Performs
calibration and validation data splits. Check out the notebook for more
details:

\href{notebooks/01-prepare-phenology.qmd}{Split data in calibration and
validation}

\section{Model Calibration}\label{model-calibration}

These three notebooks perform the model calibration. The notebook for
almond calibration has also some more comments on the different
procedures. The notebooks for apricot and sweet cherry only contain the
uncommented code.

\begin{itemize}
\item
  \href{notebooks/02-calibrate-almond.qmd}{Almond calibration}
\item
  \href{03-calibrate-apricot.qmd}{Apricot calibration}
\item
  \href{04-calibrate-cherry.qmd}{Sweet Cherry calibration}
\end{itemize}

\section{Model Evaluation}\label{model-evaluation}

This code shows how the calibrated models are evaluated. This script
generates figures and tables for the manuscript.

\href{notebooks/05-make-figures.qmd}{Generate figures for the
manuscript}

\section*{References}\label{references}
\addcontentsline{toc}{section}{References}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\vspace{1em}

\bibitem[\citeproctext]{ref-caspersen_evalpheno_2025}
Caspersen, L. (2025a). Evalpheno: {Wrapper} functions to customize
calibration of the {PhenoFlex} phenology model. Zenodo. Retrieved from
\url{https://zenodo.org/doi/10.5281/zenodo.15174551}

\bibitem[\citeproctext]{ref-caspersen_larschill_2025}
Caspersen, L. (2025b). {LarsChill}: {Supplementary} functions to the
dormancy and phenology {R}-package {chillR}. Zenodo. Retrieved from
\url{https://zenodo.org/doi/10.5281/zenodo.15174333}

\bibitem[\citeproctext]{ref-caspersen_contrasting_2025}
Caspersen, L., Schiffers, K., Picornell, A., Egea, J. A., Delgado, A.,
El Yaacoubi, A., et al. (2025). Contrasting {Responses} to {Climate}
{Change} -- {Predicting} {Bloom} of {Major} {Temperate} {Fruit} {Tree}
{Species} in the {Mediterranean} {Region} and {Central} {Europe}.
\emph{Agricultural and Forest Meteorology}, \emph{375}, 110859.
https://doi.org/\url{https://doi.org/10.1016/j.agrformet.2025.110859}

\bibitem[\citeproctext]{ref-luedeling_phenoflex_2021}
Luedeling, E., Schiffers, K., Fohrmann, T., \& Urbach, C. (2021).
Phenoflex - an {Integrated} {Model} to {Predict} {Spring} {Phenology} in
{Temperate} {Fruit} {Trees}. \emph{Agricultural and Forest Meteorology},
\emph{307}, 108491.
\url{https://doi.org/10.1016/j.agrformet.2021.108491}

\bibitem[\citeproctext]{ref-luedelingChillRStatisticalMethods2024}
Luedeling, E., Caspersen, L., \& Fernandez, E. (2024). {chillR}:
{Statistical} methods for phenology analysis in temperate fruit trees.
Contributed package for R:
https://cran.r-project.org/web/packages/chillR/. Retrieved from
\url{https://cran.r-project.org/web/packages/chillR/index.html}

\bibitem[\citeproctext]{ref-luedeling_long-term_2024}
Luedeling, E., Caspersen, L., Delgado Delgado, A., Egea, J. A., Ruiz,
D., Ben Mimoun, M., et al. (2024, May). Long-{Term} {Phenology}
{Observations} for {Temperate} {Fruit} {Trees} in the {Mediterranean}
{Region} (and {Germany}): {A} {Dataset} {Compiled} by the {Adamedor}
{Project}. bonndata. \url{https://doi.org/10.60507/FK2/MZIELI}

\end{CSLReferences}




\end{document}
